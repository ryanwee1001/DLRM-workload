Using CPU...
start to create emb, minimally need ~7.62939453125 G memory 
may actually use more memory depends on memory allocator like tcmalloc/jemalloc
current mem usage: 0.21744918823242188 G
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
Create Embedding: 500000
create emb done, current mem usage: 7.847614288330078 G
time/loss/accuracy (if enabled):
Initialize for not inference only done, current mem usage: 7.847614288330078 G
Testing for inference only
Average latency per example: 58.531ms
Total number of iterations: 128
Total number of iterations per second (across all threads): 17.09
Total time: 7.492s
Throughput: 2186.887 fps
